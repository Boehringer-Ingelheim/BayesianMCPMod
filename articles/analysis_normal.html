<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BayesianMCPMod">
<title>Analysis Example of Bayesian MCPMod for Continuous Data • BayesianMCPMod</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis Example of Bayesian MCPMod for Continuous Data">
<meta property="og:description" content="BayesianMCPMod">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BayesianMCPMod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analysis_normal.html">Analysis Example of Bayesian MCPMod for Continuous Data</a>
    <a class="dropdown-item" href="../articles/Simulation_Example.html">Simulation Example of Bayesian MCPMod for Continuous Data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Boehringer-Ingelheim/BayesianMCPMod/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analysis Example of Bayesian MCPMod for Continuous Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Boehringer-Ingelheim/BayesianMCPMod/blob/HEAD/vignettes/analysis_normal.Rmd" class="external-link"><code>vignettes/analysis_normal.Rmd</code></a></small>
      <div class="d-none name"><code>analysis_normal.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Boehringer-Ingelheim/BayesianMCPMod" class="external-link">BayesianMCPMod</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">clinDR</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: rstan</span></span>
<span><span class="co">#&gt; Loading required package: StanHeaders</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; rstan version 2.32.3 (Stan version 2.26.1)</span></span>
<span><span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span></span>
<span><span class="co">#&gt; options(mc.cores = parallel::detectCores()).</span></span>
<span><span class="co">#&gt; To avoid recompilation of unchanged Stan programs, we recommend calling</span></span>
<span><span class="co">#&gt; rstan_options(auto_write = TRUE)</span></span>
<span><span class="co">#&gt; For within-chain threading using `reduce_sum()` or `map_rect()` Stan functions,</span></span>
<span><span class="co">#&gt; change `threads_per_chain` option:</span></span>
<span><span class="co">#&gt; rstan_options(threads_per_chain = 1)</span></span>
<span><span class="co">#&gt; Loading required package: shiny</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7015</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background-and-data">Background and data<a class="anchor" aria-label="anchor" href="#background-and-data"></a>
</h2>
<p>In this vignette we will show the use of the Bayesian MCPMod package
for continuous distributed data. Hereby the focus is on the utilization
of an informative prior and the BayesianMCPMod evaluation of a single
trial. We will use data that is included in the clinDR package. More
specifically trial results for BRINTELLIX will be used to illustrate the
specification of an informative prior and the usage of such a prior for
the bayesian evaluation of a (hypothetical) new trial. More information
around BRINTELLIX to be added…</p>
</div>
<div class="section level2">
<h2 id="calculation-of-a-map-prior">Calculation of a MAP prior<a class="anchor" aria-label="anchor" href="#calculation-of-a-map-prior"></a>
</h2>
<p>In a first step a meta analytic prior will be calculated using
historical data from 4 trials (with main endpoint CfB in MADRS score
after 8 weeks). Please note that only information from the control group
will be integrated (leading to an informative multicomponent prior for
the control group), while for the active groups a non-informative prior
will be specified.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"metaData"</span><span class="op">)</span></span>
<span><span class="va">testdata</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">metaData</span><span class="op">)</span></span>
<span><span class="va">dataset</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">testdata</span>, <span class="va">bname</span> <span class="op">==</span> <span class="st">"BRINTELLIX"</span><span class="op">)</span></span>
<span><span class="va">histcontrol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">dose</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">primtime</span> <span class="op">==</span> <span class="fl">8</span>, <span class="va">indication</span> <span class="op">==</span> <span class="st">"MAJOR DEPRESSIVE DISORDER"</span>,<span class="va">protid</span><span class="op">!=</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##Create MAP Prior</span></span>
<span><span class="va">hist_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  trial <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">nctno</span>,</span>
<span>  est   <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">rslt</span>,</span>
<span>  se    <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">se</span>,</span>
<span>  sd    <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>  n     <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">sampsize</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dose_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPriorList.html">getPriorList</a></span><span class="op">(</span></span>
<span>  hist_data   <span class="op">=</span> <span class="va">hist_data</span>,</span>
<span>  dose_levels <span class="op">=</span> <span class="va">dose_levels</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specifications-new-trial">Specifications new trial<a class="anchor" aria-label="anchor" href="#specifications-new-trial"></a>
</h2>
<p>We will use the trial with ct.gov number NCT00635219 as exemplary new
trial. To be able to apply the bayesian MCPMod approach, candidate
models need to be specified. Since there are only 3 active dose levels
we will limit the set of candidate models to a linear, an exponential
and an emax model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Pre-Specification (B)MCPMod </span></span>
<span></span>
<span><span class="co">## candidate models for MCPMod</span></span>
<span><span class="co"># linear function - no guestimates needed</span></span>
<span><span class="va">exp</span>     <span class="op">&lt;-</span> <span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/guesst.html" class="external-link">guesst</a></span><span class="op">(</span>d     <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                               p     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,</span>
<span>                               model <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>                               Maxd  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dose_levels</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">emax</span>    <span class="op">&lt;-</span> <span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/guesst.html" class="external-link">guesst</a></span><span class="op">(</span>d     <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>                               p     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                               model <span class="op">=</span> <span class="st">"emax"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/Mods.html" class="external-link">Mods</a></span><span class="op">(</span></span>
<span>  linear      <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  emax        <span class="op">=</span> <span class="va">emax</span>,</span>
<span>  exponential <span class="op">=</span> <span class="va">exp</span>,</span>
<span>  doses       <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  maxEff      <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  placEff     <span class="op">=</span> <span class="op">-</span><span class="fl">12.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">primtime</span> <span class="op">==</span> <span class="fl">8</span>, <span class="va">indication</span> <span class="op">==</span> <span class="st">"MAJOR DEPRESSIVE DISORDER"</span>,<span class="va">protid</span><span class="op">==</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">142</span>, <span class="fl">147</span>, <span class="fl">149</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combination-of-prior-information-and-trial-results">Combination of prior information and trial results<a class="anchor" aria-label="anchor" href="#combination-of-prior-information-and-trial-results"></a>
</h2>
<p>As outlined in citePaper, in a first step the posterior is calculated
combining the prior information with the estimated results of the new
trial.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Simulation of new trial </span></span>
<span><span class="co">##Note: This step should not be required, as we provide summary measures directly from the new trial</span></span>
<span><span class="va">data_emax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateData.html">simulateData</a></span><span class="op">(</span></span>
<span>  n_patients  <span class="op">=</span> <span class="va">n_patients</span>,</span>
<span>  dose_levels <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  sd          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">prior_list</span>, <span class="st">"sd_tot"</span><span class="op">)</span>,</span>
<span>  mods        <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  true_model  <span class="op">=</span> <span class="st">"emax"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPosterior.html">getPosterior</a></span><span class="op">(</span>prior<span class="op">=</span><span class="va">prior_list</span>,data<span class="op">=</span><span class="va">data_emax</span>,</span>
<span>                               mu_hat <span class="op">=</span> <span class="va">new_trial</span><span class="op">$</span><span class="va">rslt</span>,</span>
<span>                               sd_hat <span class="op">=</span> <span class="va">new_trial</span><span class="op">$</span><span class="va">se</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="execution-of-bayesian-mcpmod-test-step">Execution of Bayesian MCPMod Test step<a class="anchor" aria-label="anchor" href="#execution-of-bayesian-mcpmod-test-step"></a>
</h2>
<p>For the execution of the testing step of bayesian MCPMod a critical
value (on the probability scale) will be determined for a given alpha
level. In addition a contrast matrix is created. Please note that there
are different possibilities how to generate contrasts. This information
is then used as input for the bayesian MCP testing function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crit_pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCritProb.html">getCritProb</a></span><span class="op">(</span></span>
<span>  mods           <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  dose_levels    <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  dose_weights   <span class="op">=</span> <span class="va">n_patients</span>,</span>
<span>  alpha_crit_val <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">contr_mat_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getContrMat.html">getContrMat</a></span><span class="op">(</span></span>
<span>  mods           <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  dose_levels    <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  dose_weights   <span class="op">=</span> <span class="va">n_patients</span>,</span>
<span>  prior_list     <span class="op">=</span> <span class="va">prior_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#This would be the most reasonable output, but since it is not exported it is currently not usable.</span></span>
<span><span class="co">#BMCP_result&lt;-BayesMCPi(posterior_i = posterior,</span></span>
<span>     <span class="co">#     contr_mat       = contr_mat_prior, </span></span>
<span>      <span class="co">#    crit_prob       = crit_pval)</span></span>
<span></span>
<span><span class="va">BMCP_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performBayesianMCP.html">performBayesianMCP</a></span><span class="op">(</span></span>
<span>  posteriors_list <span class="op">=</span> <span class="va">posterior</span>,</span>
<span>  contr_mat       <span class="op">=</span> <span class="va">contr_mat_prior</span>, </span>
<span> crit_prob       <span class="op">=</span> <span class="va">crit_pval</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#BMCP_result2 &lt;- performBayesianMCPMod(</span></span>
<span><span class="co">#    posteriors_list = posterior_emax,</span></span>
<span><span class="co">#    contr_mat       = contr_mat_prior, </span></span>
<span><span class="co">#    crit_prob       = crit_pval)</span></span>
<span></span>
<span><span class="co">#BMCP_result2</span></span>
<span></span>
<span><span class="va">BMCP_result</span></span>
<span><span class="co">#&gt; Bayesian Multiple Comparison Procedure</span></span>
<span><span class="co">#&gt;   Estimated Success Rate:  1 </span></span>
<span><span class="co">#&gt;   N Simulations:           1</span></span></code></pre></div>
<p>The testing step is significant indicating a non-flat dose-response
shape. In detail the p-values for the emax model is the most significant
one.</p>
</div>
<div class="section level2">
<h2 id="model-fitting-and-visualization-of-results">Model fitting and visualization of results<a class="anchor" aria-label="anchor" href="#model-fitting-and-visualization-of-results"></a>
</h2>
<p>In the model fitting step the posterior distribution is used as
basis. Both simplified and full fitting are performed. Please note that
all models are fitted to the data even though they were not significant
in the testing step. For the plotting bootstrap based credible intervals
(for 50% and 95%) are shown as well.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Model fit</span></span>
<span><span class="va">post_observed</span> <span class="op">&lt;-</span> <span class="va">posterior</span></span>
<span><span class="va">model_shapes</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"emax"</span>, <span class="st">"exponential"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Option a) Simplified approach by using frequentist idea</span></span>
<span><span class="va">fit_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getModelFits.html">getModelFits</a></span><span class="op">(</span></span>
<span>  models      <span class="op">=</span> <span class="va">model_shapes</span>,</span>
<span>  dose_levels <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  posterior   <span class="op">=</span> <span class="va">post_observed</span>,</span>
<span>  simple      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Option b) Making use of the complete posterior distribution</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getModelFits.html">getModelFits</a></span><span class="op">(</span></span>
<span>  models      <span class="op">=</span> <span class="va">model_shapes</span>,</span>
<span>  dose_levels <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  posterior   <span class="op">=</span> <span class="va">post_observed</span>,</span>
<span>  simple      <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>,cr_bands<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_normal_files/figure-html/Model%20fitting-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_simple</span>, cr_bands <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_normal_files/figure-html/Model%20fitting-2.png" width="700">
# Additional notes TBD, whether certain wrapper functions should be
mentioned.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sebastian Bossert, Stephan Wojciekowski, Lars Andersen, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
