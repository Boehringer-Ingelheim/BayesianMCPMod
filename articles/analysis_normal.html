<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis Example of Bayesian MCPMod for Continuous Data • BayesianMCPMod</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis Example of Bayesian MCPMod for Continuous Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesianMCPMod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/analysis_normal.html">Analysis Example of Bayesian MCPMod for Continuous Data</a></li>
    <li><a class="dropdown-item" href="../articles/binary_endpoint.html">Binary Endpoints in Bayesian MCP-Mod</a></li>
    <li><a class="dropdown-item" href="../articles/Simulation_Example.html">Simulation Example of Bayesian MCPMod for Continuous Data</a></li>
    <li><a class="dropdown-item" href="../articles/Simulation_Example_Binary.html">Simulation Example of Bayesian MCPMod for binary Data</a></li>
    <li><a class="dropdown-item" href="../articles/Simulation_Comparison.html">Comparison of Bayesian MCPMod and MCPMod</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Boehringer-Ingelheim/BayesianMCPMod/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="analysis_normal_files/core-js-2.5.3/shim.min.js"></script><script src="analysis_normal_files/react-18.2.0/react.min.js"></script><script src="analysis_normal_files/react-18.2.0/react-dom.min.js"></script><script src="analysis_normal_files/reactwidget-2.0.0/react-tools.js"></script><link href="analysis_normal_files/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="analysis_normal_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="analysis_normal_files/reactable-0.4.5/reactable.css" rel="stylesheet">
<script src="analysis_normal_files/reactable-binding-0.4.5/reactable.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis Example of Bayesian MCPMod for Continuous Data</h1>
            
            <h4 data-toc-skip class="date">2026-02-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Boehringer-Ingelheim/BayesianMCPMod/blob/main/vignettes/analysis_normal.Rmd" class="external-link"><code>vignettes/analysis_normal.Rmd</code></a></small>
      <div class="d-none name"><code>analysis_normal.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://boehringer-ingelheim.github.io/BayesianMCPMod/">BayesianMCPMod</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/RBesT/" class="external-link">RBesT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">clinDR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glin.github.io/reactable/" class="external-link">reactable</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7015</span><span class="op">)</span></span>
<span></span>
<span><span class="va">display_params_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">named_list</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">round_numeric</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">digits</span><span class="op">)</span> <span class="kw">else</span> <span class="va">x</span></span>
<span>  <span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Name  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">named_list</span><span class="op">)</span>,</span>
<span>    Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">named_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">v</span>, <span class="st">"Date"</span><span class="op">)</span><span class="op">)</span> <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"{"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>, <span class="va">v</span>, sep<span class="op">=</span><span class="st">"="</span>, collapse<span class="op">=</span><span class="st">", "</span><span class="op">)</span>, <span class="st">"}"</span><span class="op">)</span></span>
<span>      <span class="kw">else</span> <span class="va">v</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">tbl</span><span class="op">$</span><span class="va">Value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">$</span><span class="va">Value</span>, <span class="va">round_numeric</span><span class="op">)</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates the application of the
<code>BayesianMCPMod</code> package for analyzing a phase 2 dose-finding
trial using the Bayesian MCPMod approach.</p>
<p>A more general overview of the R package was provided with a <a href="https://github.com/Boehringer-Ingelheim/BayesianMCPMod/blob/36763ee5325955ca5d76a6c140ea3881c74e5fda/inst/PSI_Poster_2024.pdf" class="external-link">poster</a>
presented during the PSI 2024 Conference.</p>
<p>This package makes use of the <a href="https://cran.r-project.org/package=future" class="external-link">future</a> framework
for parallel processing, which can be set up for example as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span><span class="op">)</span></span></code></pre></div>
<p>Kindly note that due to overhead in many cases a reduced number of
worker nodes is preferable and that for short calculations sequential
execution can be faster.</p>
</div>
<div class="section level2">
<h2 id="calculation-of-a-map-prior">Calculation of a MAP Prior<a class="anchor" aria-label="anchor" href="#calculation-of-a-map-prior"></a>
</h2>
<p>In a first step, a meta analytic prior will be calculated using
historical data from 4 trials with main endpoint Change from baseline in
MADRS score after 8 weeks. Please note that only information from the
control group will be integrated leading to an informative mixture prior
for the control group, while for the active groups a non-informative
prior will be specified.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"metaData"</span><span class="op">)</span></span>
<span><span class="va">dataset</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">metaData</span><span class="op">)</span>, <span class="va">bname</span> <span class="op">==</span> <span class="st">"BRINTELLIX"</span><span class="op">)</span></span>
<span><span class="va">histcontrol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">dose</span>       <span class="op">==</span> <span class="fl">0</span>,</span>
<span>  <span class="va">primtime</span>   <span class="op">==</span> <span class="fl">8</span>,</span>
<span>  <span class="va">indication</span> <span class="op">==</span> <span class="st">"MAJOR DEPRESSIVE DISORDER"</span>,</span>
<span>  <span class="va">protid</span>     <span class="op">!=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hist_data</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  trial <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">nctno</span>,</span>
<span>  est   <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">rslt</span>,</span>
<span>  se    <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">se</span>,</span>
<span>  sd    <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">sd</span>,</span>
<span>  n     <span class="op">=</span> <span class="va">histcontrol</span><span class="op">$</span><span class="va">sampsize</span><span class="op">)</span></span></code></pre></div>
<p>Here, we suggest a function to construct a list of prior
distributions for the different dose groups. This function is adapted to
the needs of this example. Other applications may need a different way
to construct prior distributions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">getPriorList</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span></span>
<span>  </span>
<span>  <span class="va">hist_data</span>,</span>
<span>  <span class="va">dose_levels</span>,</span>
<span>  <span class="va">dose_names</span>    <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">robust_weight</span> <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  </span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">sd_tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">hist_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sd</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">gmap</span> <span class="op">&lt;-</span> <span class="fu">RBesT</span><span class="fu">::</span><span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/gMAP.html" class="external-link">gMAP</a></span><span class="op">(</span></span>
<span>    formula    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">est</span>, <span class="va">se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">trial</span>,</span>
<span>    weights    <span class="op">=</span> <span class="va">hist_data</span><span class="op">$</span><span class="va">n</span>,</span>
<span>    data       <span class="op">=</span> <span class="va">hist_data</span>,</span>
<span>    family     <span class="op">=</span> <span class="va">gaussian</span>,</span>
<span>    beta.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span> <span class="op">*</span> <span class="va">sd_tot</span><span class="op">)</span>,</span>
<span>    tau.dist   <span class="op">=</span> <span class="st">"HalfNormal"</span>,</span>
<span>    tau.prior  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">sd_tot</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">prior_ctr</span> <span class="op">&lt;-</span> <span class="fu">RBesT</span><span class="fu">::</span><span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/automixfit.html" class="external-link">automixfit</a></span><span class="op">(</span><span class="va">gmap</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">robust_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">prior_ctr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu">RBesT</span><span class="fu">::</span><span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/robustify.html" class="external-link">robustify</a></span><span class="op">(</span></span>
<span>      priormix <span class="op">=</span> <span class="va">prior_ctr</span>,</span>
<span>      weight   <span class="op">=</span> <span class="va">robust_weight</span>,</span>
<span>      sigma    <span class="op">=</span> <span class="va">sd_tot</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">prior_trt</span> <span class="op">&lt;-</span> <span class="fu">RBesT</span><span class="fu">::</span><span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixnorm.html" class="external-link">mixnorm</a></span><span class="op">(</span></span>
<span>    comp1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">prior_ctr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    sigma <span class="op">=</span> <span class="va">sd_tot</span>,</span>
<span>    param <span class="op">=</span> <span class="st">"mn"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">prior_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prior_ctr</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prior_trt</span><span class="op">)</span>,</span>
<span>                      times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dose_levels</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">dose_names</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">dose_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"DG_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">dose_levels</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prior_list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">dose_names</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="va">prior_list</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>With the dose levels to be investigated, the prior distribution can
be constructed.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dose_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7015</span><span class="op">)</span> <span class="co"># re-sets seed only for this example; remove in your analysis script</span></span>
<span><span class="va">prior_list</span>  <span class="op">&lt;-</span> <span class="fu">getPriorList</span><span class="op">(</span></span>
<span>  hist_data     <span class="op">=</span> <span class="va">hist_data</span>,</span>
<span>  dose_levels   <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  robust_weight <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/getESS.html">getESS</a></span><span class="op">(</span><span class="va">prior_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  Ctr DG_1 DG_2 DG_3 </span></span>
<span><span class="co">## 19.7  1.0  1.0  1.0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="dose-response-model-shapes">Dose-Response Model Shapes<a class="anchor" aria-label="anchor" href="#dose-response-model-shapes"></a>
</h2>
<p>Candidate models are specified using the {DoseFinding} package.
Models can be parameterized using guesstimates or by directly providing
distribution parameters. Note that the linear candidate model does not
require parameterization.</p>
<p><span class="aside"><strong>Note:</strong> The LinLog model is rarely
used and not currently supported by
<a href="https://boehringer-ingelheim.github.io/BayesianMCPMod/">BayesianMCPMod</a>.</span></p>
<p>In the code below, the models are “guesstimated” using the
<code><a href="https://openpharma.github.io/DoseFinding/reference/guesst.html" class="external-link">DoseFinding::guesst</a></code> function. The <code>d</code> option
usually takes a single value (a dose level), and the corresponding
<code>p</code> for the maximum effect achieved at <code>d</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Guesstimate estimation</span></span>
<span><span class="va">exp_guesst</span>  <span class="op">&lt;-</span> <span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://openpharma.github.io/DoseFinding/reference/guesst.html" class="external-link">guesst</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"exponential"</span>, </span>
<span>  d <span class="op">=</span> <span class="fl">5</span>, p <span class="op">=</span> <span class="fl">0.2</span>, Maxd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dose_levels</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">emax_guesst</span> <span class="op">&lt;-</span> <span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://openpharma.github.io/DoseFinding/reference/guesst.html" class="external-link">guesst</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"emax"</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">2.5</span>, p <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sigEmax_guesst</span> <span class="op">&lt;-</span> <span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://openpharma.github.io/DoseFinding/reference/guesst.html" class="external-link">guesst</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"sigEmax"</span>,</span>
<span>  d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">5</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">logistic_guesst</span> <span class="op">&lt;-</span> <span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://openpharma.github.io/DoseFinding/reference/guesst.html" class="external-link">guesst</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>  d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.85</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In some cases, you need to provide more information. For instance,
<code>sigEmax</code> requires a pair of <code>d</code> and
<code>p</code> values, and <code>exponential</code> requires the
specification of the maximum dose for the trial (<code>Maxd</code>).</p>
<p><span class="aside">See the help files for model specifications by
typing <code><a href="https://openpharma.github.io/DoseFinding/reference/guesst.html" class="external-link">?DoseFinding::guesst</a></code> in your console</span></p>
<p>Of course, you can also specify the models directly on the parameter
scale (without using <code><a href="https://openpharma.github.io/DoseFinding/reference/guesst.html" class="external-link">DoseFinding::guesst</a></code>).</p>
<p>For example, you can get a betaMod model by specifying
<code>delta1</code> and <code>delta2</code> parameters
(<code>scale</code> is assumed to be <code>1.2</code> of the maximum
dose), or a quadratic model with the <code>delta2</code> parameter.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">betaMod_params</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>delta1 <span class="op">=</span> <span class="fl">1</span>, delta2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">quadratic_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>delta2 <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p>Now, we can go ahead and create a <code>Mods</code> object, which
will be used in the remainder of the vignette.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://openpharma.github.io/DoseFinding/reference/Mods.html" class="external-link">Mods</a></span><span class="op">(</span></span>
<span>  linear      <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="co"># guesstimate scale</span></span>
<span>  exponential <span class="op">=</span> <span class="va">exp_guesst</span>,</span>
<span>  emax        <span class="op">=</span> <span class="va">emax_guesst</span>,</span>
<span>  sigEmax     <span class="op">=</span> <span class="va">sigEmax_guesst</span>,</span>
<span>  logistic    <span class="op">=</span> <span class="va">logistic_guesst</span>,</span>
<span>  <span class="co"># parameter scale</span></span>
<span>  betaMod     <span class="op">=</span> <span class="va">betaMod_params</span>,</span>
<span>  quadratic   <span class="op">=</span> <span class="va">quadratic_params</span>,</span>
<span>  <span class="co"># Options for all models</span></span>
<span>  doses       <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  maxEff      <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  placEff     <span class="op">=</span> <span class="op">-</span><span class="fl">12.8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mods</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_normal_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="700"></p>
<p>The <code>mods</code> object we just created above contains the full
model parameters, which can be helpful for understanding how the
guesstimates are translated onto the parameter scale.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">display_params_table</span><span class="op">(</span><span class="va">mods</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="10%">
<col width="10%">
<col width="79%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Name</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">linear</td>
<td align="left">linear</td>
<td align="left">{e0=-12.8, delta=-0.1}</td>
</tr>
<tr class="even">
<td align="left">exponential</td>
<td align="left">exponential</td>
<td align="left">{e0=-12.8, e1=-0.0666665802154335,
delta=3.60673602074522}</td>
</tr>
<tr class="odd">
<td align="left">emax</td>
<td align="left">emax</td>
<td align="left">{e0=-12.8, eMax=-1.02777777777778,
ed50=0.277777777777778}</td>
</tr>
<tr class="even">
<td align="left">sigEmax</td>
<td align="left">sigEmax</td>
<td align="left">{e0=-12.8, eMax=-1.00277008310249, ed50=2.5,
h=4.24792751344358}</td>
</tr>
<tr class="odd">
<td align="left">logistic</td>
<td align="left">logistic</td>
<td align="left">{e0=-12.7974358974359, eMax=-1.17948717948718,
ed50=7.79415312704722, delta=1.27167389072021}</td>
</tr>
<tr class="even">
<td align="left">betaMod</td>
<td align="left">betaMod</td>
<td align="left">{e0=-12.8, eMax=-1, delta1=1, delta2=1}</td>
</tr>
<tr class="odd">
<td align="left">quadratic</td>
<td align="left">quadratic</td>
<td align="left">{e0=-12.8, b1=-0.4, b2=0.04}</td>
</tr>
</tbody>
</table>
<p>And we can see the assumed treatment effects for the specified dose
groups below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu">DoseFinding</span><span class="fu">::</span><span class="fu"><a href="https://openpharma.github.io/DoseFinding/reference/Mods.html" class="external-link">getResp</a></span><span class="op">(</span><span class="va">mods</span>, doses <span class="op">=</span> <span class="va">dose_levels</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="5%">
<col width="9%">
<col width="16%">
<col width="13%">
<col width="13%">
<col width="13%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">linear</th>
<th align="right">exponential</th>
<th align="right">emax</th>
<th align="right">sigEmax</th>
<th align="right">logistic</th>
<th align="right">betaMod</th>
<th align="right">quadratic</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">-12.80</td>
<td align="right">-12.80000</td>
<td align="right">-12.80000</td>
<td align="right">-12.80000</td>
<td align="right">-12.80000</td>
<td align="right">-12.80000</td>
<td align="right">-12.80</td>
</tr>
<tr class="even">
<td align="left">2.5</td>
<td align="right">-13.05</td>
<td align="right">-12.86667</td>
<td align="right">-13.72500</td>
<td align="right">-13.30138</td>
<td align="right">-12.81551</td>
<td align="right">-13.45972</td>
<td align="right">-13.55</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">-13.30</td>
<td align="right">-13.00000</td>
<td align="right">-13.77368</td>
<td align="right">-13.75263</td>
<td align="right">-12.91538</td>
<td align="right">-13.77222</td>
<td align="right">-13.80</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="right">-13.80</td>
<td align="right">-13.80000</td>
<td align="right">-13.80000</td>
<td align="right">-13.80000</td>
<td align="right">-13.80000</td>
<td align="right">-13.35556</td>
<td align="right">-12.80</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="trial-data">Trial Data<a class="anchor" aria-label="anchor" href="#trial-data"></a>
</h3>
<p>We will use the trial with ct.gov number NCT00735709 as our phase 2
trial data, available in the <code>{clinDR}</code> package <span class="citation">(ClinicalTrials.gov 2024)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"metaData"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trial_data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">metaData</span><span class="op">)</span>, <span class="va">bname</span> <span class="op">==</span> <span class="st">"BRINTELLIX"</span><span class="op">)</span>,</span>
<span>  <span class="va">primtime</span>   <span class="op">==</span> <span class="fl">8</span>,</span>
<span>  <span class="va">indication</span> <span class="op">==</span> <span class="st">"MAJOR DEPRESSIVE DISORDER"</span>,</span>
<span>  <span class="va">protid</span>     <span class="op">==</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">128</span>, <span class="fl">124</span>, <span class="fl">129</span>, <span class="fl">122</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="posterior-calculation">Posterior Calculation<a class="anchor" aria-label="anchor" href="#posterior-calculation"></a>
</h2>
<p>In the first step of Bayesian MCPMod, the posterior is calculated by
combining the prior information with the estimated results of the trial
<span class="citation">(Fleischer F 2022)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPosterior.html">getPosterior</a></span><span class="op">(</span></span>
<span>  prior_list <span class="op">=</span> <span class="va">prior_list</span>,</span>
<span>  mu_hat     <span class="op">=</span> <span class="va">trial_data</span><span class="op">$</span><span class="va">rslt</span>,</span>
<span>  S_hat      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">trial_data</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  calc_ess   <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">2.5%</th>
<th align="right">50.0%</th>
<th align="right">97.5%</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Ctr</td>
<td align="right">-11.19915</td>
<td align="right">0.7069568</td>
<td align="right">-12.57034</td>
<td align="right">-11.20131</td>
<td align="right">-9.807192</td>
</tr>
<tr class="even">
<td align="left">DG_1</td>
<td align="right">-14.88080</td>
<td align="right">0.7130817</td>
<td align="right">-16.27841</td>
<td align="right">-14.88080</td>
<td align="right">-13.483185</td>
</tr>
<tr class="odd">
<td align="left">DG_2</td>
<td align="right">-15.07981</td>
<td align="right">0.7101057</td>
<td align="right">-16.47159</td>
<td align="right">-15.07981</td>
<td align="right">-13.688031</td>
</tr>
<tr class="even">
<td align="left">DG_3</td>
<td align="right">-15.63624</td>
<td align="right">0.7259755</td>
<td align="right">-17.05913</td>
<td align="right">-15.63624</td>
<td align="right">-14.213356</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="bayesian-mcpmod-test-step">Bayesian MCPMod Test Step<a class="anchor" aria-label="anchor" href="#bayesian-mcpmod-test-step"></a>
</h2>
<p>The testing step of Bayesian MCPMod is executed using a critical
value on the probability scale and a pseudo-optimal contrast matrix.</p>
<p>The critical value is calculated using (re-estimated) contrasts for
frequentist MCPMod to ensure error control when using weakly-informative
priors.</p>
<p>A pseudo-optimal contrast matrix is generated based on the
variability of the posterior distribution (see <span class="citation">(Fleischer F 2022)</span> for more details).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7015</span><span class="op">)</span> <span class="co"># re-sets seed only for this example; remove in your analysis script</span></span>
<span><span class="va">crit_pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCritProb.html">getCritProb</a></span><span class="op">(</span></span>
<span>  mods           <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  dose_levels    <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  cov_new_trial  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">trial_data</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  alpha_crit_val <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">contr_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getContr.html">getContr</a></span><span class="op">(</span></span>
<span>  mods          <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  dose_levels   <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  cov_posterior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Please note that there are different ways to derive the contrasts.
The following code shows the implementation of some of these ways but it
is not executed and the contrast specification above is used.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># i) the frequentist contrast</span></span>
<span><span class="va">contr_mat_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getContr.html">getContr</a></span><span class="op">(</span></span>
<span>  mods           <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  dose_levels    <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  dose_weights   <span class="op">=</span> <span class="va">n_patients</span>,</span>
<span>  prior_list     <span class="op">=</span> <span class="va">prior_list</span><span class="op">)</span></span>
<span><span class="co"># ii) re-estimated frequentist contrasts</span></span>
<span><span class="va">contr_mat_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getContr.html">getContr</a></span><span class="op">(</span></span>
<span>  mods           <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  dose_levels    <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  cov_new_trial  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">trial_data</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># iii)  Bayesian approach using number of patients for new trial and prior distribution</span></span>
<span><span class="va">contr_mat_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getContr.html">getContr</a></span><span class="op">(</span></span>
<span>  mods           <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  dose_levels    <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  dose_weights   <span class="op">=</span> <span class="va">n_patients</span>,</span>
<span>  prior_list     <span class="op">=</span> <span class="va">prior_list</span><span class="op">)</span></span></code></pre></div>
<p>The Bayesian MCP testing step is then executed:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BMCP_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/performBayesianMCP.html">performBayesianMCP</a></span><span class="op">(</span></span>
<span>  posterior_list <span class="op">=</span> <span class="va">posterior</span>,</span>
<span>  contr          <span class="op">=</span> <span class="va">contr_mat</span>, </span>
<span>  crit_prob_adj  <span class="op">=</span> <span class="va">crit_pval</span><span class="op">)</span></span></code></pre></div>
<p>Summary information:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BMCP_result</span></span></code></pre></div>
<pre><code><span><span class="co">## Bayesian Multiple Comparison Procedure</span></span>
<span><span class="co">##   Significant:                   1 </span></span>
<span><span class="co">##   Critical Probability:          0.9845439 </span></span>
<span><span class="co">##   Maximum Posterior Probability: 0.9999998 </span></span>
<span><span class="co">## Posterior Probabilities for Model Shapes</span></span>
<span><span class="co">##                        lin       exp      emax      sigE       log     betaM      quad</span></span>
<span><span class="co">##   Posterior Prob 0.9999581 0.9981522 0.9999998 0.9999985 0.9953674 0.9999930 0.9883779 </span></span>
<span><span class="co">##   Significant            1         1         1         1         1         1         1 </span></span>
<span><span class="co">## Average Posterior ESS</span></span>
<span><span class="co">##   Dose Level:     Ctr  DG_1  DG_2  DG_3 </span></span>
<span><span class="co">##   Avg Post ESS: 189.9 186.6 188.2 180.0</span></span></code></pre>
<p>The testing step is significant, indicating a non-flat dose-response
shape. All models are significant, with the <code>emax</code> model
indicating the greatest deviation from the null hypothesis.</p>
</div>
<div class="section level2">
<h2 id="model-fitting-and-visualization">Model Fitting and Visualization<a class="anchor" aria-label="anchor" href="#model-fitting-and-visualization"></a>
</h2>
<p>In the model fitting step the posterior distribution is used as
basis.</p>
<p>Both simplified and full fitting are performed.</p>
<p>For the simplified fit, the multivariate normal distribution of the
control group is approximated and reduced by a one-dimensional normal
distribution.</p>
<p>The actual fit (on this approximated posterior distribution) is then
performed using generalized least squares criterion. In contrast, for
the full fit, the non-linear optimization problem is addressed via the
Nelder-Mead algorithm <span class="citation">(Wikipedia 2024)</span>
implemented by the <a href="https://github.com/astamm/nloptr" class="external-link">nloptr</a> package.</p>
<p>The output of the fit includes information about the predicted
effects for the included dose levels, the generalized AIC, and the
corresponding weights.</p>
<p>For the considered case, the simplified and the full fit are very
similar, so we present the full fit.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If simple = TRUE, uses approx posterior</span></span>
<span><span class="co"># Here we use complete posterior distribution</span></span>
<span><span class="va">model_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getModelFits.html">getModelFits</a></span><span class="op">(</span></span>
<span>  models      <span class="op">=</span> <span class="va">mods</span>,</span>
<span>  dose_levels <span class="op">=</span> <span class="va">dose_levels</span>,</span>
<span>  posterior   <span class="op">=</span> <span class="va">posterior</span>,</span>
<span>  simple      <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Estimates for dose levels not included in the trial:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">display_params_table</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_fits</span>, doses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="15%">
<col width="15%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Name</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">avgFit</td>
<td align="left">avgFit</td>
<td align="left">-11.292, -14.684, -15.134, -15.315, -15.518,
-15.530</td>
</tr>
<tr class="even">
<td align="left">betaMod</td>
<td align="left">betaMod</td>
<td align="left">-11.246, -14.787, -15.099, -15.246, -15.450,
-15.556</td>
</tr>
<tr class="odd">
<td align="left">emax</td>
<td align="left">emax</td>
<td align="left">-11.244, -14.805, -15.133, -15.257, -15.407,
-15.528</td>
</tr>
<tr class="even">
<td align="left">exponential</td>
<td align="left">exponential</td>
<td align="left">-12.586, -13.358, -13.870, -14.233, -15.016,
-16.348</td>
</tr>
<tr class="odd">
<td align="left">linear</td>
<td align="left">linear</td>
<td align="left">-12.403, -13.397, -13.994, -14.391, -15.187,
-16.380</td>
</tr>
<tr class="even">
<td align="left">logistic</td>
<td align="left">logistic</td>
<td align="left">-11.245, -14.837, -15.273, -15.352, -15.390,
-15.395</td>
</tr>
<tr class="odd">
<td align="left">quadratic</td>
<td align="left">quadratic</td>
<td align="left">-11.474, -14.104, -15.165, -15.658, -16.126,
-15.535</td>
</tr>
<tr class="even">
<td align="left">sigEmax</td>
<td align="left">sigEmax</td>
<td align="left">-11.243, -14.810, -15.092, -15.217, -15.394,
-15.565</td>
</tr>
</tbody>
</table>
<p>Plots of fitted dose-response models and an AIC-based average
model:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_fits</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_normal_files/figure-html/unnamed-chunk-15-1.png" class="r-plt" alt="" width="700"></p>
<p>To assess the uncertainty, one can additionally visualize credible
bands (orange shaded areas, default levels are 50% and 95%).</p>
<p>These credible bands are calculated with a bootstrap method as
follows:</p>
<ul>
<li><p>Samples from the posterior distribution are drawn and for every
sample the simplified fitting step and a prediction is
performed.</p></li>
<li><p>These predictions are then used to identify and visualize the
specified quantiles.</p></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_fits</span>, cr_bands <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_normal_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" alt="" width="700"></p>
<p>The bootstrap-based quantiles can also be directly calculated via the
<code><a href="../reference/getBootstrapQuantiles.html">getBootstrapQuantiles()</a></code> function and a sample from the
model fits can bootstrapped using
<code><a href="../reference/getBootstrapSamples.html">getBootstrapSamples()</a></code>.</p>
<p>For this example, only 10 samples are bootstrapped for each model
fit.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7015</span><span class="op">)</span> <span class="co"># re-sets seed only for this example; remove in your analysis script</span></span>
<span><span class="va">bootstrap_quantiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getBootstrapQuantiles.html">getBootstrapQuantiles</a></span><span class="op">(</span></span>
<span>  model_fits <span class="op">=</span> <span class="va">model_fits</span>,</span>
<span>  quantiles  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  doses      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  n_samples  <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>The bootstrap quantiles include information about the absolute
quantiles (sample_type=abs) and also about the placebo-adjusted (resp.
control-adjusted) quantiles (sample_type=diff).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reactable</span><span class="fu">::</span><span class="fu"><a href="https://glin.github.io/reactable/reference/reactable.html" class="external-link">reactable</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">bootstrap_quantiles</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">q_prob</span>, values_from <span class="op">=</span> <span class="va">q_val</span><span class="op">)</span>,</span>
<span>  groupBy <span class="op">=</span> <span class="st">"model"</span>,</span>
<span>  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose    <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>aggregated <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>suffix <span class="op">=</span> <span class="st">" dose"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"0.025"</span> <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"0.5"</span>   <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"0.975"</span> <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="reactable html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"model":["avgFit","avgFit","avgFit","avgFit","avgFit","avgFit","avgFit","avgFit","avgFit","avgFit","avgFit","avgFit","betaMod","betaMod","betaMod","betaMod","betaMod","betaMod","betaMod","betaMod","betaMod","betaMod","betaMod","betaMod","emax","emax","emax","emax","emax","emax","emax","emax","emax","emax","emax","emax","exponential","exponential","exponential","exponential","exponential","exponential","exponential","exponential","exponential","exponential","exponential","exponential","linear","linear","linear","linear","linear","linear","linear","linear","linear","linear","linear","linear","logistic","logistic","logistic","logistic","logistic","logistic","logistic","logistic","logistic","logistic","logistic","logistic","quadratic","quadratic","quadratic","quadratic","quadratic","quadratic","quadratic","quadratic","quadratic","quadratic","quadratic","quadratic","sigEmax","sigEmax","sigEmax","sigEmax","sigEmax","sigEmax","sigEmax","sigEmax","sigEmax","sigEmax","sigEmax","sigEmax"],"dose":[0,0,2.5,2.5,4,4,5,5,7,7,10,10,0,0,2.5,2.5,4,4,5,5,7,7,10,10,0,0,2.5,2.5,4,4,5,5,7,7,10,10,0,0,2.5,2.5,4,4,5,5,7,7,10,10,0,0,2.5,2.5,4,4,5,5,7,7,10,10,0,0,2.5,2.5,4,4,5,5,7,7,10,10,0,0,2.5,2.5,4,4,5,5,7,7,10,10,0,0,2.5,2.5,4,4,5,5,7,7,10,10],"sample_type":["abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff","abs","diff"],"0.025":[-11.4921200819023,0,-15.0701414807694,-4.16628896340237,-16.0647296405785,-4.93807064114316,-16.612694569065,-5.47732729798316,-16.9390377381655,-5.74736146430768,-16.8481575672607,-5.87197860295483,-11.5212970809626,0,-15.2163716089795,-4.16893497393592,-15.98963962744,-4.95200793876496,-16.3447918370482,-5.42522800389621,-16.6298696223115,-5.6760223136475,-16.8624101764806,-5.88570263930757,-11.4897484530431,0,-15.3823553202084,-4.32075994131106,-15.6676752578724,-4.67447943442445,-15.7828765394528,-4.8476384167904,-16.2337020670488,-5.24033968601105,-16.8481575672607,-5.87197860295483,-13.1303837750303,0,-13.8378682493648,-1.09264479460378,-14.3109450629196,-1.81687857352451,-14.6805778051596,-2.3307735575753,-15.6693803004571,-3.43895829448069,-17.5303715485936,-5.32354606642112,-12.9114757778687,0,-13.8404974240155,-1.3853197022307,-14.4114296892851,-2.21651152356911,-14.8432732990012,-2.77063940446139,-15.8712810075233,-3.87889516624595,-17.5109711321681,-5.54127880892278,-11.489789524218,0,-15.22368491888,-4.22064000108073,-15.9567905274236,-4.90327598519291,-15.9722278113426,-4.99804621675061,-16.4029567467069,-5.36007975127234,-16.7619095250038,-5.72906642476949,-12.1330781904287,0,-14.7617905679283,-3.60773990329882,-16.0647296405785,-4.93807064114316,-16.612694569065,-5.47732729798316,-16.9629861462208,-5.74736146430768,-16.8752931992677,-5.75021892743915,-11.489775292706,0,-15.2229060858139,-4.19329257088385,-15.9477257626352,-4.85752394960979,-15.9651225902353,-4.88797188371857,-16.2658722985538,-5.24217636572428,-16.8567426459956,-5.88570497834052],"0.5":[-11.0001954299054,0,-14.6667961670285,-3.54502881966086,-15.2503637375221,-4.38218484426612,-15.6366426878,-4.69756377874493,-16.0266643906125,-5.1308906941594,-15.743259532871,-4.41861682174639,-11.0057074746345,0,-14.6522352849275,-3.61352543266296,-15.2474234836602,-4.32843018315515,-15.6296917799534,-4.69938295418719,-16.0553340346197,-5.17228913297055,-15.7747887108704,-4.53984295558073,-11.0001954299054,0,-14.835785199067,-3.80212579928395,-15.118190315843,-4.22893507733222,-15.4036547626722,-4.49673301279219,-15.7390637790158,-4.67525665774652,-15.9951630669197,-4.82703095592331,-12.596457638889,0,-13.4118015211553,-0.779906375339706,-14.0107359562664,-1.29684888420093,-14.3671957445054,-1.66365608110123,-15.2316910649048,-2.45465453332931,-16.6868131845406,-3.79983278840587,-12.3723468432492,0,-13.4496672914684,-1.02204093326237,-14.1141137318232,-1.63526549321979,-14.5317751443137,-2.04408186652474,-15.4148922088649,-2.86171461313463,-16.7395678056918,-4.08816373304947,-11.0228933175045,0,-14.6345503975093,-3.63843253031648,-15.3321172749032,-4.34979597568046,-15.6966656033556,-4.71275095412798,-15.8356183958272,-4.81475947329164,-15.8566036877997,-4.81475947329164,-11.2119435067019,0,-14.0898262742262,-2.91917670389612,-15.3142558629886,-4.17112225388362,-15.8778062890825,-4.7976024237294,-16.4409466770933,-5.37165978606087,-15.7341025034293,-4.41861682174639,-11.0013211876137,0,-14.6527528345796,-3.65773400947358,-15.2434575167639,-4.29986919713635,-15.5734480234912,-4.58723809241907,-15.782778340732,-4.81490110439554,-15.8960934609031,-4.81493734090322],"0.975":[-10.5079688412091,0,-14.0926881910381,-2.83611858988757,-15.0396354251976,-3.64758422998583,-15.1059208124558,-3.71419258719152,-15.1165205288087,-3.72479230354443,-14.5225871912034,-3.61298742497033,-10.4938979344948,0,-14.1330576654737,-2.85992772939834,-14.9627662386759,-3.63405243670663,-15.1462746192707,-3.72223637074438,-15.1662143551302,-3.74217610660386,-14.513238211438,-3.53630421763313,-10.4925664553108,0,-14.1763369941205,-3.07058137205456,-14.8309442364997,-3.60970392927808,-14.9132627610613,-3.67607523252593,-14.9915521598621,-3.71634468591877,-15.052625328023,-3.73285758385872,-12.1095461354325,0,-13.0822648986982,-0.596737051179541,-13.5662556395935,-0.992270102480523,-13.8802705397087,-1.27292871991313,-14.5432887140257,-1.87815275550916,-15.6296275184904,-2.90740156104121,-11.8825428032827,0,-13.0877852172401,-0.769073473462944,-13.6638948109815,-1.23051755754071,-14.0153813305951,-1.53814694692589,-14.7102815044014,-2.15340572569624,-15.7201211018377,-3.07629389385177,-10.5012948813295,0,-14.0108711194708,-2.81576277040257,-15.1003712860588,-3.70282532643969,-15.1003712860603,-3.70988808979154,-15.1003712860603,-3.70988808979154,-15.1003712860603,-3.70988808979154,-10.5593569101508,0,-13.6847902951539,-1.82509075772662,-14.6890230762231,-2.62887576503806,-15.1035174780455,-3.02998081086644,-15.5952340274815,-3.47359951106539,-14.5241763929717,-3.26585113974385,-10.4881838803106,0,-14.1340026390279,-2.85992817666648,-14.9759473452671,-3.69620220436994,-15.1034885010092,-3.71293186099351,-15.1113816653081,-3.72644123317534,-15.1113913057791,-3.73881727936527]},"columns":[{"id":"model","name":"model","type":"character"},{"id":"dose","name":"dose","type":"numeric","format":{"aggregated":{"suffix":" dose"}}},{"id":"sample_type","name":"sample_type","type":"character"},{"id":"0.025","name":"0.025","type":"numeric","format":{"cell":{"digits":4}}},{"id":"0.5","name":"0.5","type":"numeric","format":{"cell":{"digits":4}}},{"id":"0.975","name":"0.975","type":"numeric","format":{"cell":{"digits":4}}}],"groupBy":["model"],"dataKey":"165df67de72f93edc59a33b6373ab686"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p><strong>Technical note:</strong> The median quantile of the bootstrap
based procedure is not necessary similar to the main model fit, as they
are derived via different procedures.</p>
<p>The main fit (black line) minimizes residuals for the posterior
distribution, while the bootstrap median is the median fit of random
sampling.</p>
</div>
<div class="section level2">
<h2 id="assessment-of-the-minimally-efficacious-dose">Assessment of the Minimally Efficacious Dose<a class="anchor" aria-label="anchor" href="#assessment-of-the-minimally-efficacious-dose"></a>
</h2>
<p>The Minimally Efficacious Dose (MED) per model shape can be assessed
with the function <code><a href="../reference/getMED.html">getMED()</a></code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getMED.html">getMED</a></span><span class="op">(</span></span>
<span>  delta       <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  model_fits  <span class="op">=</span> <span class="va">model_fits</span>,</span>
<span>  dose_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">dose_levels</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dose_levels</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             avgFit betaMod emax exponential linear logistic quadratic sigEmax</span></span>
<span><span class="co">## med_reached   1.00    1.00 1.00           0      0      1.0      1.00    1.00</span></span>
<span><span class="co">## med           4.86    5.01 4.88          NA     NA      3.8      4.59    5.25</span></span></code></pre>
<p>For an optional Bayesian decision rule for the MED assessment and
further details, please see <code>?getMED()</code>.</p>
</div>
<div class="section level2">
<h2 id="additional-note">Additional Note<a class="anchor" aria-label="anchor" href="#additional-note"></a>
</h2>
<p>Testing, modeling, and MED assessment can also be combined via
<code><a href="../reference/performBayesianMCPMod.html">performBayesianMCPMod()</a></code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/performBayesianMCPMod.html">performBayesianMCPMod</a></span><span class="op">(</span></span>
<span>  posterior_list   <span class="op">=</span> <span class="va">posterior</span>,</span>
<span>  contr            <span class="op">=</span> <span class="va">contr_mat</span>,</span>
<span>  crit_prob_adj    <span class="op">=</span> <span class="va">crit_pval</span>,</span>
<span>  delta            <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  simple           <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-nct00735709_2024a" class="csl-entry">
ClinicalTrials.gov. 2024. <span>“NCT00735709.”</span> <a href="https://clinicaltrials.gov/study/NCT00735709?term=NCT00735709&amp;rank=1" class="external-link">https://clinicaltrials.gov/study/NCT00735709?term=NCT00735709&amp;rank=1</a>.
</div>
<div id="ref-fleischer_2022" class="csl-entry">
Fleischer F, Deng Q, Bossert S. 2022. <span>“Bayesian MCPMod.”</span>
<em>Pharmaceutical Statistics</em> 21 (3): 654–70.
</div>
<div id="ref-neldermead_2024a" class="csl-entry">
Wikipedia. 2024. <span>“Nelder-Mead Method.”</span> <a href="https://en.wikipedia.org/wiki/Nelder-Mead_method" class="external-link">https://en.wikipedia.org/wiki/Nelder-Mead_method</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Boehringer Ingelheim Pharma GmbH &amp; Co. KG, Stephan Wojciekowski, Lars Andersen, Sebastian Bossert.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
