<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comparison of Bayesian MCPMod and MCPMod â€¢ BayesianMCPMod</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparison of Bayesian MCPMod and MCPMod">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesianMCPMod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/analysis_normal.html">Analysis Example of Bayesian MCPMod for Continuous Data</a></li>
    <li><a class="dropdown-item" href="../articles/Simulation_Example.html">Simulation Example of Bayesian MCPMod for Continuous Data</a></li>
    <li><a class="dropdown-item" href="../articles/Simulation_Comparison.html">Comparison of Bayesian MCPMod and MCPMod</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Boehringer-Ingelheim/BayesianMCPMod/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="Simulation_Comparison_files/kePrint-0.0.1/kePrint.js"></script><link href="Simulation_Comparison_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comparison of Bayesian MCPMod and MCPMod</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Boehringer-Ingelheim/BayesianMCPMod/blob/main/vignettes/Simulation_Comparison.Rmd" class="external-link"><code>vignettes/Simulation_Comparison.Rmd</code></a></small>
      <div class="d-none name"><code>Simulation_Comparison.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://boehringer-ingelheim.github.io/BayesianMCPMod/">BayesianMCPMod</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/openpharma/DoseFinding" class="external-link">DoseFinding</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/medianasoft/MCPModPack" class="external-link">MCPModPack</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates the application of the <a href="https://CRAN.R-project.org/package=BayesianMCPMod" class="external-link">BayesianMCPMod</a>
package for sample size calculations and the comparison with the <a href="https://CRAN.R-project.org/package=MCPModPack" class="external-link">MCPModPack</a>
package. Bayesian MCPMod is set up in a way that it mimics the results
(and operating characteristics) of the frequentist MCPMod for vague
priors. This characteristic is illustrated in the following sections
focusing on the trial planning.</p>
<p>The following dose-finding scenario is considered to compare Bayesian
MCPMod and MCPModPack success probabilities:</p>
<ul>
<li><p>Four dose levels plus placebo (0 mg, 1 mg, 2 mg, 4 mg, 8
mg)</p></li>
<li><p>Total sample size of N = 200 with an equal allocation ratio for
each dose group, i.e., 40 per group</p></li>
<li><p>Standard deviation of 0.4 for every dose group</p></li>
<li><p>Alpha level of 5%</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses_sim</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span> </span>
<span><span class="va">n_sample</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">sd_sim</span>        <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span></span>
<span><span class="va">max_dose</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">doses_sim</span><span class="op">)</span>    </span>
<span><span class="va">plc_eff_guess</span> <span class="op">&lt;-</span> <span class="fl">0</span>    </span>
<span></span>
<span><span class="va">alpha</span>         <span class="op">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
<p>Simulations are performed with 10000 runs. Given the number of
simulations and applying the law of large numbers, the difference in
success probabilities should be in the range of 1% - 3%.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7015</span><span class="op">)</span></span>
<span><span class="va">n_sim</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html" class="external-link">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>In the following figure shows the considered candidate models.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">emax_guess</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/guesst.html" class="external-link">guesst</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">doses_sim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, p <span class="op">=</span> <span class="fl">0.6</span>, <span class="st">"emax"</span><span class="op">)</span> </span>
<span><span class="va">exp_guess</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/guesst.html" class="external-link">guesst</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">doses_sim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, p <span class="op">=</span> <span class="fl">0.05</span>, model <span class="op">=</span> <span class="st">"exponential"</span>, Maxd <span class="op">=</span> <span class="va">max_dose</span><span class="op">)</span></span>
<span><span class="va">logit_guess</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/guesst.html" class="external-link">guesst</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">doses_sim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">doses_sim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>, <span class="st">"logistic"</span>, Maxd <span class="op">=</span> <span class="va">max_dose</span><span class="op">)</span> </span>
<span><span class="va">sig_emax_guess</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/guesst.html" class="external-link">guesst</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">doses_sim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">doses_sim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.75</span><span class="op">)</span>, model <span class="op">=</span> <span class="st">"sigEmax"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/Mods.html" class="external-link">Mods</a></span><span class="op">(</span>linear      <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          exponential <span class="op">=</span> <span class="va">exp_guess</span>,</span>
<span>          emax        <span class="op">=</span> <span class="va">emax_guess</span>,</span>
<span>          logistic    <span class="op">=</span> <span class="va">logit_guess</span>,</span>
<span>          sigEmax     <span class="op">=</span> <span class="va">sig_emax_guess</span>,</span>
<span>          doses       <span class="op">=</span> <span class="va">doses_sim</span>,</span>
<span>          placEff     <span class="op">=</span> <span class="va">plc_eff_guess</span>,</span>
<span>          direction   <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Candidate Models"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Simulation_Comparison_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="varying-the-expected-effect-for-maximum-dose">Varying the Expected Effect for Maximum Dose<a class="anchor" aria-label="anchor" href="#varying-the-expected-effect-for-maximum-dose"></a>
</h2>
<p>The following expected effects are studied:</p>
<ul>
<li>Expected effect for maximum dose of 0.0001, 0.05, 0.1, 0.2, 0.3, and
0.5</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0001</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>The value of 0.0001 was chosen instead of 0 due to technical reasons.
This case should mimic the null scenario (where we expect a success
probability close to the alpha level).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulation parameters</span></span>
<span><span class="va">sim_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n            <span class="op">=</span> <span class="va">n_sample</span>,</span>
<span>                       doses        <span class="op">=</span> <span class="va">doses_sim</span>,</span>
<span>                       dropout_rate <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>                       go_threshold <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                       nsims        <span class="op">=</span> <span class="va">n_sim</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Candidate dose - response models</span></span>
<span><span class="va">models_MCPModPack</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linear      <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                         exponential <span class="op">=</span> <span class="va">exp_guess</span>,</span>
<span>                         emax        <span class="op">=</span> <span class="va">emax_guess</span>,</span>
<span>                         logistic    <span class="op">=</span> <span class="va">logit_guess</span>,</span>
<span>                         sigemax     <span class="op">=</span> <span class="va">sig_emax_guess</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assumed dose - response models (models will be added in loop)</span></span>
<span><span class="va">sim_models_part</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max_effect     <span class="op">=</span> <span class="va">exp_eff</span>,</span>
<span>                        sd             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">sd_sim</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">doses_sim</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        placebo_effect <span class="op">=</span> <span class="va">plc_eff_guess</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parallelization across assumed dose - response models</span></span>
<span><span class="va">powers_MCPModPack_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">models_MCPModPack</span><span class="op">)</span>,</span>
<span>  .combine <span class="op">=</span> <span class="va">cbind</span>, </span>
<span>  .options.future <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://doFuture.futureverse.org/reference/grapes-dofuture-grapes.html" class="external-link">%dofuture%</a></span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">sim_model_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">models_MCPModPack</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, <span class="va">sim_models_part</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/MCPModPack/man/MCPModSimulation.html" class="external-link">MCPModSimulation</a></span><span class="op">(</span>endpoint_type   <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>                     models          <span class="op">=</span> <span class="va">models_MCPModPack</span>,</span>
<span>                     alpha           <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                     direction       <span class="op">=</span> <span class="st">"increasing"</span>,</span>
<span>                     model_selection <span class="op">=</span> <span class="st">"aveAIC"</span>,</span>
<span>                     Delta           <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                     sim_models      <span class="op">=</span> <span class="va">sim_model_k</span>,</span>
<span>                     sim_parameters  <span class="op">=</span> <span class="va">sim_parameters</span><span class="op">)</span><span class="op">$</span><span class="va">sim_results</span><span class="op">$</span><span class="va">power</span></span>
<span>  </span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="co"># Post-processing result for printing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">powers_MCPModPack_eff</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models_MCPModPack</span><span class="op">)</span></span>
<span><span class="va">results_MCPModPack_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>max_eff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">exp_eff</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                                <span class="va">powers_MCPModPack_eff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>sigEmax <span class="op">=</span> <span class="va">sigemax</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>average <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">linear</span><span class="op">:</span><span class="va">sigEmax</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vague prior specification</span></span>
<span><span class="va">prior_list_vague</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RBesT</span><span class="fu">::</span><span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixnorm.html" class="external-link">mixnorm</a></span><span class="op">(</span>comp1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                            sigma <span class="op">=</span> <span class="va">sd_sim</span>, param <span class="op">=</span> <span class="st">"mn"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">doses_sim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prior_list_vague</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctrl"</span>, <span class="st">"DG_1"</span>, <span class="st">"DG_2"</span>, <span class="st">"DG_3"</span>, <span class="st">"DG_4"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parallelization across the expected effects for maximum dose</span></span>
<span><span class="va">success_rates_BayesianMCPMod_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span></span>
<span>  k               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">exp_eff</span><span class="op">)</span>,</span>
<span>  .combine        <span class="op">=</span> <span class="va">rbind</span>, </span>
<span>  .options.future <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://doFuture.futureverse.org/reference/grapes-dofuture-grapes.html" class="external-link">%dofuture%</a></span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">exp_eff_k</span> <span class="op">&lt;-</span> <span class="va">exp_eff</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">models_BayesianMCPMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/Mods.html" class="external-link">Mods</a></span><span class="op">(</span>linear      <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                  exponential <span class="op">=</span> <span class="va">exp_guess</span>,</span>
<span>                                  emax        <span class="op">=</span> <span class="va">emax_guess</span>,</span>
<span>                                  logistic    <span class="op">=</span> <span class="va">logit_guess</span>,</span>
<span>                                  sigEmax     <span class="op">=</span> <span class="va">sig_emax_guess</span>,</span>
<span>                                  doses       <span class="op">=</span> <span class="va">doses_sim</span>,</span>
<span>                                  placEff     <span class="op">=</span> <span class="va">plc_eff_guess</span>,</span>
<span>                                  maxEff      <span class="op">=</span> <span class="va">exp_eff_k</span>,</span>
<span>                                  direction   <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span></span>
<span>       </span>
<span>    <span class="co"># Optimal contrasts</span></span>
<span>    <span class="va">contr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getContr.html">getContr</a></span><span class="op">(</span>mods         <span class="op">=</span> <span class="va">models_BayesianMCPMod</span>,</span>
<span>                      dose_levels  <span class="op">=</span> <span class="va">doses_sim</span>,</span>
<span>                      prior_list   <span class="op">=</span> <span class="va">prior_list_vague</span>,</span>
<span>                      dose_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">doses_sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>    <span class="co"># Perform Simulations</span></span>
<span>    <span class="va">sim_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessDesign.html">assessDesign</a></span><span class="op">(</span>n_patients     <span class="op">=</span> <span class="va">n_sample</span>,</span>
<span>                               mods           <span class="op">=</span> <span class="va">models_BayesianMCPMod</span>,</span>
<span>                               prior_list     <span class="op">=</span> <span class="va">prior_list_vague</span>,</span>
<span>                               sd             <span class="op">=</span> <span class="va">sd_sim</span>,</span>
<span>                               n_sim          <span class="op">=</span> <span class="va">n_sim</span>,</span>
<span>                               alpha_crit_val <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                               contr          <span class="op">=</span> <span class="va">contr</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_result</span>, <span class="va">attr</span>, <span class="st">"successRate"</span><span class="op">)</span>,</span>
<span>      average <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">sim_result</span>, <span class="st">"avgSuccessRate"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="co"># Post-processing result for printing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">success_rates_BayesianMCPMod_eff</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">results_BayesianMCPMod_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>max_eff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">exp_eff</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                                           <span class="va">success_rates_BayesianMCPMod_eff</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The following plot shows the differences between the results obtained
with MCPModPack and BayesianMCPMod. The results of BayesianMCPMod are
shown as horizontal lines and the differences to the results of
MCPModPack are presented as vertical lines. As the results are close to
one another, the vertical lines are barely visible. The colours indicate
the different assumed true dose-response models, which were the basis
for simulating the data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## pre-processing the data</span></span>
<span><span class="va">df_plot_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">results_MCPModPack_eff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>package_name <span class="op">=</span> <span class="st">"MCPModPack"</span><span class="op">)</span>,</span>
<span>                     <span class="va">results_BayesianMCPMod_eff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>package_name <span class="op">=</span> <span class="st">"BayesianMCPMod"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results_BayesianMCPMod_eff</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>               names_to  <span class="op">=</span> <span class="st">"model_shape"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"success_rate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">model_shape</span> <span class="op">!=</span> <span class="st">"average"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">package_name</span>, value <span class="op">=</span> <span class="va">success_rate</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">model_shape</span><span class="op">)</span>,</span>
<span>         max_eff     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">max_eff</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">max_eff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>offset <span class="op">=</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">model_shape</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">model_shape</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot with short horizontal dashes for each model_shape</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot_eff</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">max_eff</span><span class="op">)</span> <span class="op">+</span> <span class="va">offset</span>, y <span class="op">=</span> <span class="va">BayesianMCPMod</span>, color <span class="op">=</span> <span class="va">model_shape</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">max_eff</span><span class="op">)</span> <span class="op">+</span> <span class="va">offset</span> <span class="op">-</span> <span class="fl">0.05</span>, xend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">max_eff</span><span class="op">)</span> <span class="op">+</span> <span class="va">offset</span> <span class="op">+</span> <span class="fl">0.05</span>,</span>
<span>                   y <span class="op">=</span> <span class="va">BayesianMCPMod</span>, yend <span class="op">=</span> <span class="va">BayesianMCPMod</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">max_eff</span><span class="op">)</span> <span class="op">+</span> <span class="va">offset</span>, yend <span class="op">=</span> <span class="va">MCPModPack</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">df_plot_eff</span><span class="op">$</span><span class="va">max_eff</span><span class="op">)</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">df_plot_eff</span><span class="op">$</span><span class="va">max_eff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title    <span class="op">=</span> <span class="st">"Comparing Power and Success Rate"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"For Different Expected Effects for Maximum Dose"</span>,</span>
<span>       x        <span class="op">=</span> <span class="st">"Expected Effect for Maximum Dose"</span>,</span>
<span>       y        <span class="op">=</span> <span class="st">"Success Rate / Power"</span>,</span>
<span>       color    <span class="op">=</span> <span class="st">"Assumed True Model Shapes"</span>,</span>
<span>       linetype <span class="op">=</span> <span class="st">"Type"</span>,</span>
<span>       caption  <span class="op">=</span> <span class="st">"Horizontal lines represent the BayesianMCPMod success rates and vertical lines mark the distance to the MCPModPack power."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Simulation_Comparison_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>As expected, the operating characteristics of BayesianMCPMod with
vague priors match the operating characteristics of frequentist
MCPMod.</p>
<p>Numerical results are shown in the two tables below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">results_MCPModPack_eff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_header_above.html" class="external-link">add_header_above</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Power Values Across Different Expected Effects"</span> <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>                     font_size <span class="op">=</span> <span class="fl">15</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_header_above.html" class="external-link">add_header_above</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCPModPack"</span> <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, font_size <span class="op">=</span> <span class="fl">15</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
<thead>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; font-size: 15px;" colspan="7">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
MCPModPack
</div>
</th>
</tr>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; font-size: 15px;" colspan="7">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Power Values Across Different Expected Effects
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
max_eff
</th>
<th style="text-align:right;">
linear
</th>
<th style="text-align:right;">
exponential
</th>
<th style="text-align:right;">
emax
</th>
<th style="text-align:right;">
logistic
</th>
<th style="text-align:right;">
sigEmax
</th>
<th style="text-align:right;">
average
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.0522
</td>
<td style="text-align:right;">
0.0462
</td>
<td style="text-align:right;">
0.0513
</td>
<td style="text-align:right;">
0.0488
</td>
<td style="text-align:right;">
0.0510
</td>
<td style="text-align:right;">
0.04990
</td>
</tr>
<tr>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.1370
</td>
<td style="text-align:right;">
0.1399
</td>
<td style="text-align:right;">
0.1417
</td>
<td style="text-align:right;">
0.1760
</td>
<td style="text-align:right;">
0.1702
</td>
<td style="text-align:right;">
0.15296
</td>
</tr>
<tr>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.3027
</td>
<td style="text-align:right;">
0.3053
</td>
<td style="text-align:right;">
0.3028
</td>
<td style="text-align:right;">
0.4193
</td>
<td style="text-align:right;">
0.3985
</td>
<td style="text-align:right;">
0.34572
</td>
</tr>
<tr>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.7486
</td>
<td style="text-align:right;">
0.7601
</td>
<td style="text-align:right;">
0.7623
</td>
<td style="text-align:right;">
0.9066
</td>
<td style="text-align:right;">
0.8846
</td>
<td style="text-align:right;">
0.81244
</td>
</tr>
<tr>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.9696
</td>
<td style="text-align:right;">
0.9743
</td>
<td style="text-align:right;">
0.9715
</td>
<td style="text-align:right;">
0.9978
</td>
<td style="text-align:right;">
0.9956
</td>
<td style="text-align:right;">
0.98176
</td>
</tr>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.00000
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">results_BayesianMCPMod_eff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_header_above.html" class="external-link">add_header_above</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Success Rates Across Different Expected Effects"</span> <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>                     font_size <span class="op">=</span> <span class="fl">15</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_header_above.html" class="external-link">add_header_above</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BayesianMCPMod"</span> <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, font_size <span class="op">=</span> <span class="fl">15</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<table class="table  lightable-classic" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
<thead>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; font-size: 15px;" colspan="7">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
BayesianMCPMod
</div>
</th>
</tr>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; font-size: 15px;" colspan="7">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Success Rates Across Different Expected Effects
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
max_eff
</th>
<th style="text-align:right;">
linear
</th>
<th style="text-align:right;">
exponential
</th>
<th style="text-align:right;">
emax
</th>
<th style="text-align:right;">
logistic
</th>
<th style="text-align:right;">
sigEmax
</th>
<th style="text-align:right;">
average
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.0457
</td>
<td style="text-align:right;">
0.0457
</td>
<td style="text-align:right;">
0.0457
</td>
<td style="text-align:right;">
0.0457
</td>
<td style="text-align:right;">
0.0457
</td>
<td style="text-align:right;">
0.04570
</td>
</tr>
<tr>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.1349
</td>
<td style="text-align:right;">
0.1309
</td>
<td style="text-align:right;">
0.1335
</td>
<td style="text-align:right;">
0.1692
</td>
<td style="text-align:right;">
0.1618
</td>
<td style="text-align:right;">
0.14606
</td>
</tr>
<tr>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.3070
</td>
<td style="text-align:right;">
0.3027
</td>
<td style="text-align:right;">
0.3015
</td>
<td style="text-align:right;">
0.4192
</td>
<td style="text-align:right;">
0.3923
</td>
<td style="text-align:right;">
0.34454
</td>
</tr>
<tr>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.7518
</td>
<td style="text-align:right;">
0.7559
</td>
<td style="text-align:right;">
0.7519
</td>
<td style="text-align:right;">
0.9029
</td>
<td style="text-align:right;">
0.8736
</td>
<td style="text-align:right;">
0.80722
</td>
</tr>
<tr>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.9708
</td>
<td style="text-align:right;">
0.9744
</td>
<td style="text-align:right;">
0.9690
</td>
<td style="text-align:right;">
0.9969
</td>
<td style="text-align:right;">
0.9948
</td>
<td style="text-align:right;">
0.98118
</td>
</tr>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.00000
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="convergence-of-power-values">Convergence of Power Values<a class="anchor" aria-label="anchor" href="#convergence-of-power-values"></a>
</h2>
<p>In the following simulations, we examine the convergence of power and
success rate values for an increasing number of simulations. For this,
the expected maximum effect is fixed at 0.2.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_eff_fix</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>The R package MCPModPack provides a final power result for a given
number of simulations and does not allow accessing intermediate power
values.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_sim_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span></span></code></pre></div>
<p>This is why the simulation is repeated for different values of number
of simulations for the implementation with MCPModPack.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Updating the assumed dose - response models for the fixed expected effect (models will be added in loop)</span></span>
<span><span class="va">sim_models_part</span><span class="op">$</span><span class="va">max_effect</span> <span class="op">&lt;-</span> <span class="va">exp_eff_fix</span></span>
<span></span>
<span><span class="co"># Parallelization across assumed dose - response models &amp; number of simulations</span></span>
<span><span class="co">## Reversing the numbers speeds up parallelization in case there are not enough workers</span></span>
<span><span class="va">sim_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models_MCPModPack</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">n_sim_vec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">powers_MCPModPack_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim_grid</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  .combine <span class="op">=</span> <span class="va">c</span>,</span>
<span>  .options.future <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://doFuture.futureverse.org/reference/grapes-dofuture-grapes.html" class="external-link">%dofuture%</a></span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">sim_model_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">models_MCPModPack</span><span class="op">[</span><span class="va">sim_grid</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">sim_models_part</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">sim_params_k</span> <span class="op">&lt;-</span> <span class="va">sim_parameters</span></span>
<span>    <span class="va">sim_params_k</span><span class="op">$</span><span class="va">nsims</span> <span class="op">&lt;-</span> <span class="va">sim_grid</span><span class="op">[</span><span class="va">k</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/MCPModPack/man/MCPModSimulation.html" class="external-link">MCPModSimulation</a></span><span class="op">(</span>endpoint_type   <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>                     models          <span class="op">=</span> <span class="va">models_MCPModPack</span>,</span>
<span>                     alpha           <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                     direction       <span class="op">=</span> <span class="st">"increasing"</span>,</span>
<span>                     model_selection <span class="op">=</span> <span class="st">"aveAIC"</span>,</span>
<span>                     Delta           <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                     sim_models      <span class="op">=</span> <span class="va">sim_model_k</span>,</span>
<span>                     sim_parameters  <span class="op">=</span> <span class="va">sim_params_k</span><span class="op">)</span><span class="op">$</span><span class="va">sim_results</span><span class="op">$</span><span class="va">power</span></span>
<span>  </span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="co">#Post-processing</span></span>
<span><span class="va">results_MCPModPack_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">sim_grid</span>, <span class="va">powers_MCPModPack_conv</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>model_name   <span class="op">=</span> <span class="va">Var1</span>,</span>
<span>         n_sim        <span class="op">=</span> <span class="va">Var2</span>,</span>
<span>         success_rate <span class="op">=</span> <span class="va">powers_MCPModPack_conv</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">model_name</span> <span class="op">==</span> <span class="st">"sigemax"</span>,</span>
<span>                             <span class="st">"sigEmax"</span>, <span class="va">model_name</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>package_name <span class="op">=</span> <span class="st">"MCPModPack"</span><span class="op">)</span></span></code></pre></div>
<p>In the BayesianMCPMod implementation, only one simulation run is
required to access the estimated success rate values at different
numbers of simulations.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model specifications with fixed expected effect</span></span>
<span><span class="va">models_BayesianMCPMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoseFinding/man/Mods.html" class="external-link">Mods</a></span><span class="op">(</span>linear      <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                              exponential <span class="op">=</span> <span class="va">exp_guess</span>,</span>
<span>                              emax        <span class="op">=</span> <span class="va">emax_guess</span>,</span>
<span>                              logistic    <span class="op">=</span> <span class="va">logit_guess</span>,</span>
<span>                              sigEmax     <span class="op">=</span> <span class="va">sig_emax_guess</span>,</span>
<span>                              doses       <span class="op">=</span> <span class="va">doses_sim</span>,</span>
<span>                              placEff     <span class="op">=</span> <span class="va">plc_eff_guess</span>,</span>
<span>                              maxEff      <span class="op">=</span> <span class="va">exp_eff_fix</span>,</span>
<span>                              direction   <span class="op">=</span> <span class="st">"increasing"</span><span class="op">)</span></span>
<span>       </span>
<span><span class="co"># Optimal contrasts</span></span>
<span><span class="va">contr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getContr.html">getContr</a></span><span class="op">(</span>mods         <span class="op">=</span> <span class="va">models_BayesianMCPMod</span>,</span>
<span>                  dose_levels  <span class="op">=</span> <span class="va">doses_sim</span>,</span>
<span>                  prior_list   <span class="op">=</span> <span class="va">prior_list_vague</span>,</span>
<span>                  dose_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">doses_sim</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform Simulations</span></span>
<span><span class="va">sim_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assessDesign.html">assessDesign</a></span><span class="op">(</span>n_patients     <span class="op">=</span> <span class="va">n_sample</span>,</span>
<span>                           mods           <span class="op">=</span> <span class="va">models_BayesianMCPMod</span>,</span>
<span>                           prior_list     <span class="op">=</span> <span class="va">prior_list_vague</span>,</span>
<span>                           sd             <span class="op">=</span> <span class="va">sd_sim</span>,</span>
<span>                           n_sim          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">n_sim_vec</span><span class="op">)</span>,</span>
<span>                           alpha_crit_val <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                           contr          <span class="op">=</span> <span class="va">contr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Getting success rates at different numbers of simulations</span></span>
<span><span class="va">results_BayesianMCPMod_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_result</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">model_result</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">n_sim_vec</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">n_sim_x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">success_rate_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">model_result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_sim_x</span><span class="op">)</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Post-processing</span></span>
<span>  <span class="va">as.data.frame</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n_sim <span class="op">=</span> <span class="va">n_sim_vec</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">n_sim</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"model_name"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"success_rate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>package_name <span class="op">=</span> <span class="st">"BayesianMCPMod"</span><span class="op">)</span></span></code></pre></div>
<p>The figure below shows the convergence of the power and success rate
values for an increasing number of simulations.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_plot_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">results_BayesianMCPMod_conv</span>,</span>
<span>                           <span class="va">results_MCPModPack_conv</span>,</span>
<span>                           by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model_name"</span>, <span class="st">"n_sim"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>success_rate_diff <span class="op">=</span> <span class="va">success_rate.x</span> <span class="op">-</span> <span class="va">success_rate.y</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model_name</span>, <span class="va">n_sim</span>, <span class="va">success_rate_diff</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot_conv</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n_sim</span>, y <span class="op">=</span> <span class="va">success_rate_diff</span>, color <span class="op">=</span> <span class="va">model_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df_plot_conv</span><span class="op">$</span><span class="va">n_sim</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title   <span class="op">=</span> <span class="st">"Success Rate Difference vs Number of Simulations"</span>,</span>
<span>    x       <span class="op">=</span> <span class="st">"Number of Simulations"</span>,</span>
<span>    y       <span class="op">=</span> <span class="st">"Success Rate Difference"</span>,</span>
<span>    color   <span class="op">=</span> <span class="st">"True Model Shape"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"The success rate difference is the difference of the success rates calculated </span></span>
<span><span class="st">    with BayesianMCPMod and the power values calculated with MCPModPack."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Simulation_Comparison_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>As expected, the differences are within the range of 1% - 3%.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Boehringer Ingelheim Pharma GmbH &amp; Co.Â KG, Stephan Wojciekowski, Lars Andersen, Sebastian Bossert.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
